<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title th:text="${pageTitle} ?: 'Hệ thống Quản lý Gym'">Default Title</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* (CSS Giữ nguyên) */
        body { min-height: 100vh; background-color: #f8f9fa; }
        .sidebar { position: fixed; top: 0; left: 0; bottom: 0; width: 260px; padding: 60px 0 0; box-shadow: 0 2px 5px 0 rgb(0 0 0 / 5%), 0 2px 10px 0 rgb(0 0 0 / 5%); z-index: 1000; background-color: #fff; }
        .sidebar .nav-link { color: #333; font-weight: 500; padding: 10px 20px; }
        .sidebar .nav-link.active { color: #0d6efd; background-color: #e7f1ff; }
        .sidebar .nav-link:hover { background-color: #f8f9fa; }
        .topbar { position: fixed; top: 0; right: 0; left: 260px; height: 60px; background-color: #fff; box-shadow: 0 2px 5px 0 rgb(0 0 0 / 5%), 0 2px 10px 0 rgb(0 0 0 / 5%); z-index: 1001; padding: 0 2rem; }
        .main-content { margin-left: 260px; padding: 80px 2rem 2rem; }
    </style>
</head>
<body>

<header sec:authorize="isAuthenticated()" class="topbar d-flex justify-content-end align-items-center">
    <form th:action="@{/logout}" method="post" class="d-flex">
        <span class="navbar-text me-3">
            Xin chào,
            <span sec:authentication="principal.fullName">Username</span>!
        </span>
        <button class="btn btn-outline-primary" type="submit">Đăng xuất</button>
    </form>
</header>

<nav class="sidebar" sec:authorize="isAuthenticated()">
    <div class="d-flex justify-content-center align-items-center p-3 mb-2 border-bottom" style="height: 60px; position: absolute; top: 0; width: 100%;">
        <a class="navbar-brand fs-4 fw-bold" th:href="@{/default}">GYM ADMIN</a>
    </div>

    <ul class="nav flex-column">
        <li class="nav-item px-3 py-2 text-muted text-uppercase small" style="font-size: .75rem;">
            Nghiệp vụ
        </li>

        <li class="nav-item">
            <a class="nav-link" th:href="@{/check-in}"
               th:classappend="${activePage == 'checkIn'} ? 'active' : ''">
                Check-in (Quầy)
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" th:href="@{/members}"
               th:classappend="${activePage == 'members'} ? 'active' : ''">
                Quản lý Hội viên
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" th:href="@{/pos}"
               th:classappend="${activePage == 'pos'} ? 'active' : ''">
                Bán hàng (POS)
            </a>
        </li>

        <div sec:authorize="hasRole('ADMIN')">
            <li class="nav-item px-3 py-2 mt-3 text-muted text-uppercase small" style="font-size: .75rem;">
                Quản trị
            </li>
            <li class="nav-item">
                <a class="nav-link" th:href="@{/admin/users}"
                   th:classappend="${activePage == 'adminUsers'} ? 'active' : ''">
                    Quản lý Nhân viên
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" th:href="@{/admin/packages}"
                   th:classappend="${activePage == 'adminPackages'} ? 'active' : ''">
                    Quản lý Gói tập
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" th:href="@{/admin/products}"
                   th:classappend="${activePage == 'adminProducts'} ? 'active' : ''">
                    Quản lý Sản phẩm
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" th:href="@{/admin/schedules}"
                   th:classappend="${activePage == 'adminSchedules'} ? 'active' : ''">
                    Quản lý Lịch làm việc
                </a>
            </li>
        </div>
    </ul>
</nav>

<main class="main-content">
    <div th:replace="~{${contentView} :: content}">
        <h1>Chào mừng!</h1>
        <p>Vui lòng chọn một chức năng từ thanh điều hướng bên trái.</p>
    </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>